\part{Type conversion}
\frame{\partpage}

\begin{frame}[fragile]{Numeric type conversion}
    \begin{itemize}
        \item Most conversions happen automatically on assignment \pause
        \item Conversions that can ``lose'' data will give compiler warnings
    \end{itemize}
    \pause
    \begin{lstlisting}
int a = 27;
double b = a;    // OK
double c = 12.3;
int d = c;       // Warning
    \end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Explicit type conversion}
    \begin{itemize}
        \item Common pitfall: an \lstinline{int} divided by an \lstinline{int} is an \lstinline{int}
    \end{itemize}
    \pause
    \begin{lstlisting}
int a = 3;
int b = 2;
double fraction = a / b;
std::cout << fraction << std::endl; // Prints 1.0
    \end{lstlisting}
    \pause
    \begin{itemize}
        \item The code calculates \lstinline{a / b} as an \lstinline{int}, then converts the result to a \lstinline{double} \pause
        \item Need to \textbf{cast} the \lstinline{int}s to \lstinline{double}s to get the desired result
    \end{itemize}
    \pause
    \begin{lstlisting}
double fraction = static_cast<double>(a) / static_cast<double>(b);
std::cout << fraction << std::endl; // Prints 1.5
    \end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Static cast}
    \begin{itemize}
        \item \lstinline{static_cast<Type>(value)} is for type conversions that the compiler can verify are valid \pause
        \item E.g. converting between basic (numeric) types \pause
        \item E.g. converting (pointer to derived class) to (pointer to base class)
    \end{itemize}
    \begin{lstlisting}
Circle* myCircle = new Circle(1);
Shape* myShape = static_cast<Shape*>(myCircle);
    \end{lstlisting}
\end{frame}

\begin{frame}[fragile]{Dynamic casting}
    \begin{itemize}
        \item Some casts can fail at runtime \pause
        \item E.g. converting (pointer to base class) to (pointer to derived class) \pause
        \item E.g. we have a \lstinline{Shape*} and want to convert it to a \lstinline{Circle*},
            but what if it's actually a \lstinline{Square*}? \pause
        \item \lstinline{dynamic_cast<Circle*>(myPointer)} will convert the pointer if possible,
            otherwise it will evaluate to \lstinline{nullptr}
    \end{itemize}
\end{frame}

\begin{frame}[fragile]{Other types of cast}
    \begin{itemize}
        \item \lstinline{reinterpret_cast<>()} reinterprets the bytes in memory as a different type
        \begin{itemize}
            \item This is dangerous, and only useful in certain specialised circumstances
        \end{itemize}
        \pause
        \item \textbf{C-style casts} can behave like \lstinline{static_cast} or \lstinline{reinterpret_cast} depending on context
        \begin{itemize}
            \item Syntax: \lstinline{(Type)value} \pause
            \item Also dangerous, but often used for converting between basic (numeric) types
        \end{itemize}
    \end{itemize}
\end{frame}

\begin{frame}[fragile]{C-style casts}
    \begin{lstlisting}
double fraction = static_cast<double>(a) / static_cast<double>(b);
    \end{lstlisting}
    \pause
    \begin{itemize}
        \item You may see this written as
    \end{itemize}
    \begin{lstlisting}
double fraction = (double)a / (double)b;
    \end{lstlisting}
    \pause
    \begin{itemize}
        \item This is more concise, but many C++ programmers consider it bad style
    \end{itemize}
\end{frame}

\begin{frame}[fragile]{Converting to and from strings}
    \begin{itemize}
        \item You \textbf{can't} use typecasting to convert values to and from strings \pause
        \item Instead, use \lstinline{stringstream} \pause
        \item There are many examples online
    \end{itemize}
\end{frame}

